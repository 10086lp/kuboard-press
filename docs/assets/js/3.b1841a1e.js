(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{145:function(t,a,e){t.exports=e.p+"assets/img/image-20190723121433809.7a1b4b00.png"},261:function(t,a,e){t.exports=e.p+"assets/img/image-20190723150525017.378015c8.png"},262:function(t,a,e){t.exports=e.p+"assets/img/image-20190723150616633.17a9797e.png"},263:function(t,a,e){t.exports=e.p+"assets/img/image-20190723150853277.c168bc57.png"},264:function(t,a,e){t.exports=e.p+"assets/img/image-20190723151045112.5329884a.png"},265:function(t,a,e){t.exports=e.p+"assets/img/image-20190723151103353.3c29b906.png"},266:function(t,a,e){t.exports=e.p+"assets/img/image-20190723151339137.5f756564.png"},267:function(t,a,e){t.exports=e.p+"assets/img/image-20190723151357262.e79d2b6c.png"},268:function(t,a,e){t.exports=e.p+"assets/img/image-20190723151422460.f02b1a28.png"},269:function(t,a,e){t.exports=e.p+"assets/img/image-20190723151711230.c3dd4c41.png"},270:function(t,a,e){t.exports=e.p+"assets/img/image-20190723151804727.287fa561.png"},271:function(t,a,e){t.exports=e.p+"assets/img/image-20190723151845303.f2b8415a.png"},272:function(t,a,e){t.exports=e.p+"assets/img/image-20190723151902003.1ef39b19.png"},273:function(t,a,e){t.exports=e.p+"assets/img/image-20190723151914994.fa026f01.png"},274:function(t,a,e){t.exports=e.p+"assets/img/image-20190723151932871.cbc894da.png"},275:function(t,a,e){t.exports=e.p+"assets/img/image-20190723151951910.c3248933.png"},276:function(t,a,e){t.exports=e.p+"assets/img/image-20190723152020605.31eccc82.png"},277:function(t,a,e){t.exports=e.p+"assets/img/image-20190723152040219.45660f67.png"},278:function(t,a,e){t.exports=e.p+"assets/img/image-20190723152124196.9ef1af43.png"},279:function(t,a,e){t.exports=e.p+"assets/img/image-20190718104156232.8f0c70ed.png"},280:function(t,a,e){t.exports=e.p+"assets/img/image-20190718104729472.ef92267c.png"},281:function(t,a,e){t.exports=e.p+"assets/img/image-20190718105420599.71e5df51.png"},282:function(t,a,e){t.exports=e.p+"assets/img/image-20190718105641651.16549369.png"},283:function(t,a,e){t.exports=e.p+"assets/img/image-20190718120957255.0e01130f.png"},284:function(t,a,e){t.exports=e.p+"assets/img/image-20190718121133160.0d0a8e13.png"},359:function(t,a,e){"use strict";e.r(a);var s=e(0),i=Object(s.a)({},function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"监控-example"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#监控-example","aria-hidden":"true"}},[t._v("#")]),t._v(" 监控 example "),s("Badge",{attrs:{text:"alpha",type:"warn"}})],1),t._v(" "),s("h2",{attrs:{id:"前提"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#前提","aria-hidden":"true"}},[t._v("#")]),t._v(" 前提")]),t._v(" "),s("p",[t._v("必须具备如下条件：")]),t._v(" "),s("ul",[s("li",[t._v("已完成 "),s("a",{attrs:{href:"/guide/example/import"}},[t._v("导入 example 微服务")])])]),t._v(" "),s("div",{staticClass:"warning custom-block"},[s("p",[t._v("监控套件相关的功能目前处于 alpha 状态，虽然在实际投产项目中取得了非常好的效果，但是产品化封装还需要进一步改进。")])]),t._v(" "),s("p",[t._v("假设您已进入 example 名称空间，如下图所示：")]),t._v(" "),s("p",[s("img",{attrs:{src:e(145),alt:"image-20190723121433809"}})]),t._v(" "),s("h2",{attrs:{id:"安装监控套件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装监控套件","aria-hidden":"true"}},[t._v("#")]),t._v(" 安装监控套件")]),t._v(" "),s("h3",{attrs:{id:"安装全局监控套件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装全局监控套件","aria-hidden":"true"}},[t._v("#")]),t._v(" 安装全局监控套件")]),t._v(" "),s("ul",[s("li",[t._v("在 master 节点执行")])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("kubectl -n kube-system create secret generic etcd-certs --from-file"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/etc/kubernetes/pki/etcd/server.crt --from-file"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/etc/kubernetes/pki/etcd/server.key\n")])])]),s("ul",[s("li",[t._v("将鼠标移到 "),s("em",[s("strong",[t._v("设置")])]),t._v(" 菜单")])]),t._v(" "),s("p",[s("img",{attrs:{src:e(261),alt:"image-20190723150525017"}})]),t._v(" "),s("ul",[s("li",[t._v("点击 "),s("em",[s("strong",[t._v("监控套件 - example")])])])]),t._v(" "),s("p",[s("img",{attrs:{src:e(262),alt:"image-20190723150616633"}})]),t._v(" "),s("ul",[s("li",[t._v("点击 "),s("em",[s("strong",[t._v("全局监控套件 / 查找并安装")])])])]),t._v(" "),s("p",[s("img",{attrs:{src:e(263),alt:"image-20190723150853277"}})]),t._v(" "),s("ul",[s("li",[t._v("点击 "),s("em",[s("strong",[t._v("资源层监控套件 / 安装")])])])]),t._v(" "),s("p",[s("img",{attrs:{src:e(264),alt:"image-20190723151045112"}})]),t._v(" "),s("ul",[s("li",[t._v("点击 "),s("em",[s("strong",[t._v("全局监控套件 / 资源层监控套件 / 安装")])])])]),t._v(" "),s("p",[s("img",{attrs:{src:e(265),alt:"image-20190723151103353"}})]),t._v(" "),s("ul",[s("li",[t._v("根据向导提示，完成工作负载的导入")])]),t._v(" "),s("p",[s("img",{attrs:{src:e(266),alt:"image-20190723151339137"}})]),t._v(" "),s("ul",[s("li",[s("p",[t._v("点击 "),s("em",[s("strong",[t._v("资源层监控套件 / 初始化")])])]),t._v(" "),s("p",[t._v("由于下载镜像需要时间，您可能需要等待5-10分钟后，才能成功执行初始化。初始化成功的话，您将看到如下提示信息。")])])]),t._v(" "),s("p",[s("img",{attrs:{src:e(267),alt:"image-20190723151357262"}})]),t._v(" "),s("h3",{attrs:{id:"安装名称空间监控套件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装名称空间监控套件","aria-hidden":"true"}},[t._v("#")]),t._v(" 安装名称空间监控套件")]),t._v(" "),s("ul",[s("li",[t._v("点击 "),s("em",[s("strong",[t._v("名称空间监控套件 example / 查找并安装")])])])]),t._v(" "),s("p",[s("img",{attrs:{src:e(268),alt:"image-20190723151422460"}})]),t._v(" "),s("ul",[s("li",[s("p",[t._v("重复前述过程，安装监控套件")]),t._v(" "),s("p",[t._v("重复前述过程，完成如下监控套件的安装和初始化：")]),t._v(" "),s("ul",[s("li",[t._v("Pinpoint 监控套件")]),t._v(" "),s("li",[t._v("Prometheus 监控套件")]),t._v(" "),s("li",[t._v("熔断及限流 Sentinel")])]),t._v(" "),s("p",[t._v("安装完成后，界面如下图所示：")])])]),t._v(" "),s("p",[s("img",{attrs:{src:e(269),alt:"image-20190723151711230"}})]),t._v(" "),s("h3",{attrs:{id:"查看监控套件的工作负载"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#查看监控套件的工作负载","aria-hidden":"true"}},[t._v("#")]),t._v(" 查看监控套件的工作负载")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("点击 "),s("em",[s("strong",[t._v("后退")])])]),t._v(" "),s("p",[t._v("回到名称空间后，可查看到刚才安装监控套件时导入的监控层工作负载。")]),t._v(" "),s("blockquote",[s("p",[t._v("全局监控套件安装在 kube-system 名称空间")])])])]),t._v(" "),s("p",[s("img",{attrs:{src:e(270),alt:"image-20190723151804727"}})]),t._v(" "),s("h2",{attrs:{id:"重启-example-容器组"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#重启-example-容器组","aria-hidden":"true"}},[t._v("#")]),t._v(" 重启 example 容器组")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("点击导航栏中的 "),s("em",[s("strong",[t._v("容器组列表")])])]),t._v(" "),s("p",[t._v("在筛选条件中选择")]),t._v(" "),s("ul",[s("li",[t._v("展现层")]),t._v(" "),s("li",[t._v("网关层")]),t._v(" "),s("li",[t._v("服务层")]),t._v(" "),s("li",[t._v("持久层")]),t._v(" "),s("li",[t._v("中间件")])]),t._v(" "),s("p",[t._v("并点击刷新")]),t._v(" "),s("blockquote",[s("ul",[s("li",[s("p",[t._v("Kuboard 创建工作负载时，默认将其 imagePullPolicy 设置为 "),s("strong",[t._v("Always")]),t._v("；")])]),t._v(" "),s("li",[s("p",[t._v("删除容器组时，Kubernetes 将为该工作负载启动一个新的容器组，以尽可能地使工作负载的容器组数量等于该工作负载期望的副本数（replicas）；")])]),t._v(" "),s("li",[s("p",[t._v("Kubernetes 在启动容器组时，根据 imagePullPolicy 的设置 Always，将会尝试从镜像仓库抓取最新镜像，这一特性，可以用于开发环境和测试环境的版本更新，因为您的 devops 系统肯能不会为 daily build 生成新的镜像标签；")])]),t._v(" "),s("li",[s("p",[t._v("此处删除容器组的目的是，重新启动容器，以便容器中的监控探针能够检测到其对应监控套件的存在。")])])])])])]),t._v(" "),s("p",[s("img",{attrs:{src:e(271),alt:"image-20190723151845303"}})]),t._v(" "),s("ul",[s("li",[s("p",[t._v("在列表中选择")]),t._v(" "),s("p",[t._v("选中如下容器组：")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("cloud-eureka-0")])]),t._v(" "),s("li",[s("p",[t._v("db-example-xxxxxx-xxxx")])]),t._v(" "),s("li",[s("p",[t._v("gateway-example-xxxxxx-xxxx")])]),t._v(" "),s("li",[s("p",[t._v("svc-example-xxxxxx-xxxx")])]),t._v(" "),s("li",[s("p",[t._v("web-example-xxxxxx-xxxx")])])])])]),t._v(" "),s("p",[s("img",{attrs:{src:e(272),alt:"image-20190723151902003"}})]),t._v(" "),s("ul",[s("li",[t._v("点击 "),s("em",[s("strong",[t._v("删除")])]),t._v(" 按钮")])]),t._v(" "),s("p",[s("img",{attrs:{src:e(273),alt:"image-20190723151914994"}})]),t._v(" "),s("ul",[s("li",[t._v("点击 "),s("em",[s("strong",[t._v("确定")])])])]),t._v(" "),s("p",[s("img",{attrs:{src:e(274),alt:"image-20190723151932871"}})]),t._v(" "),s("ul",[s("li",[t._v("点击 "),s("em",[s("strong",[t._v("应用")])])])]),t._v(" "),s("p",[s("img",{attrs:{src:e(275),alt:"image-20190723151951910"}})]),t._v(" "),s("ul",[s("li",[t._v("等待，直到容器组调整完成")])]),t._v(" "),s("p",[s("img",{attrs:{src:e(276),alt:"image-20190723152020605"}})]),t._v(" "),s("ul",[s("li",[t._v("点击 "),s("em",[s("strong",[t._v("后退")])])])]),t._v(" "),s("p",[s("img",{attrs:{src:e(277),alt:"image-20190723152040219"}})]),t._v(" "),s("h2",{attrs:{id:"查看监控信息"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#查看监控信息","aria-hidden":"true"}},[t._v("#")]),t._v(" 查看监控信息")]),t._v(" "),s("h3",{attrs:{id:"查看资源层监控信息"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#查看资源层监控信息","aria-hidden":"true"}},[t._v("#")]),t._v(" 查看资源层监控信息")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("点击 "),s("em",[s("strong",[t._v("展现层 / web-example")])])]),t._v(" "),s("p",[t._v("如果您在下图中没有看到 "),s("em",[s("strong",[t._v("Nginx 监控")])]),t._v("， "),s("em",[s("strong",[t._v("容器组监控")])]),t._v(" 等，请刷新您的页面，因为监控套件初始化之后需要刷新页面才能加载并显示。")])])]),t._v(" "),s("p",[s("img",{attrs:{src:e(278),alt:"image-20190723152124196"}})]),t._v(" "),s("ul",[s("li",[s("p",[t._v("点击 "),s("em",[s("strong",[t._v("所在节点监控")])])]),t._v(" "),s("p",[t._v("可查看所在节点的资源使用情况监控信息")])])]),t._v(" "),s("p",[s("img",{attrs:{src:e(279),alt:"image-20190718104156232"}})]),t._v(" "),s("h3",{attrs:{id:"查看中间件层监控信息"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#查看中间件层监控信息","aria-hidden":"true"}},[t._v("#")]),t._v(" 查看中间件层监控信息")]),t._v(" "),s("h4",{attrs:{id:"查看-nginx-监控"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#查看-nginx-监控","aria-hidden":"true"}},[t._v("#")]),t._v(" 查看 Nginx 监控")]),t._v(" "),s("ul",[s("li",[t._v("点击 Nginx 监控")])]),t._v(" "),s("p",[s("img",{attrs:{src:e(280),alt:"image-20190718104729472"}})]),t._v(" "),s("h4",{attrs:{id:"查看-mysql-监控"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#查看-mysql-监控","aria-hidden":"true"}},[t._v("#")]),t._v(" 查看 MySQL 监控")]),t._v(" "),s("ul",[s("li",[t._v("返回 "),s("em",[s("strong",[t._v("example")])]),t._v(" 名称空间")]),t._v(" "),s("li",[t._v("点击 "),s("em",[s("strong",[t._v("持久层 / example db")])])]),t._v(" "),s("li",[t._v("点击 "),s("em",[s("strong",[t._v("MySQL 监控")])])])]),t._v(" "),s("p",[s("img",{attrs:{src:e(281),alt:"image-20190718105420599"}})]),t._v(" "),s("h4",{attrs:{id:"查看-jvm-监控"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#查看-jvm-监控","aria-hidden":"true"}},[t._v("#")]),t._v(" 查看 JVM 监控")]),t._v(" "),s("ul",[s("li",[t._v("返回 "),s("em",[s("strong",[t._v("example")])]),t._v(" 名称空间")]),t._v(" "),s("li",[t._v("点击 "),s("em",[s("strong",[t._v("微服务层 / example")])])]),t._v(" "),s("li",[t._v("点击 "),s("em",[s("strong",[t._v("Java 虚拟机监控")])])])]),t._v(" "),s("p",[s("img",{attrs:{src:e(282),alt:"image-20190718105641651"}})]),t._v(" "),s("h3",{attrs:{id:"查看链路追踪监控信息"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#查看链路追踪监控信息","aria-hidden":"true"}},[t._v("#")]),t._v(" 查看链路追踪监控信息")]),t._v(" "),s("ul",[s("li",[t._v("在 "),s("em",[s("strong",[t._v("微服务层 / example")])]),t._v(" 中点击 "),s("em",[s("strong",[t._v("链路追踪")])])])]),t._v(" "),s("p",[s("img",{attrs:{src:e(283),alt:"image-20190718120957255"}})]),t._v(" "),s("p",[s("img",{attrs:{src:e(284),alt:"image-20190718121133160"}})])])},[],!1,null,null,null);a.default=i.exports}}]);